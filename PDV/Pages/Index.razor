@page "/"

@using PDV.Shared.Components
@using PDV.Data


<PageTitle>Index</PageTitle>

@inject ProdutoService service

<div class="p-3 mb-3 text-white text-center"><img src="logo.png" /></div>

<div class="form-group">
@*    <label for="name"></label>
    <input type="text" id="nome" class="form-control" @bind-value="@ChooseProduct.Nome" @onkeyup="(() => GetProdutoByNome())"/>
*@
    <select class="form-select" aria-label="Default select example">
        <option value="1">Escolha a Mesa</option>
        <option value="1">Mesa 1</option>
        <option value="2">Mesa 2</option>
        <option value="3">Mesa 3</option>
        <option value="2">Mesa 4</option>
        <option value="3">Mesa 5</option>
    </select>

</div>

<div class="text-center p-3 mb-3">
    <button class="btn btn-info" @onclick="(() => GetProdutoByNome())">Abri Caixa</button>
    <button class="btn btn-info" @onclick="(() => GetProdutoByNome())">Fechar Caixa</button>
    <button class="btn btn-info" @onclick="(() => GetProdutoByNome())">Sangria</button>
    <button class="btn btn-info" @onclick="(() => GetProdutoByNome())">Histórico</button>
    <button class="btn btn-info" @onclick="(() => GetProdutoByNome())">?????</button>
</div>


@code {
    List<Produto> Produtos = new List<Produto>();
    protected override async Task OnInitializedAsync()
    {
        await RefreshProducts();
    }

    private async Task RefreshProducts()
    {
        Produtos = await service.GetProdutosAsync();
        //Produtos = await service.GetProdutoByNomeAsync();
    }

    private async Task RefreshProductByNome(string nome)
    {
        Produtos = await service.GetProdutoByNomeAsync(nome);
    }

    Produto ChooseProduct = new Produto();
    private async Task GetProdutoByNome()
    {
        //ChooseProduct = produto;
        await RefreshProductByNome(ChooseProduct.Nome);
    }

    public Produto NewProduct { get; set; } = new Produto();
    private async Task AddNewProduct()
    {
        await service.AddProdutoAsync(NewProduct);
        NewProduct = new Produto();
        await RefreshProducts();
    }
    Produto UpdateProduct = new Produto();
    private void SetProductForUpdate(Produto produto)
    {
        UpdateProduct = produto;
    }
    private async Task UpdateProductData()
    {
        await service.UpdateProdutoAsync(UpdateProduct);
        await RefreshProducts();
    }
    private async Task DeleteProduct(Produto produto)
    {
        await service.DeleteProdutoAsync(produto);
        await RefreshProducts();
    }
}

